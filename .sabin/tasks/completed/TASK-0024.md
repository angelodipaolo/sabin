---
status: resolved
title: support for specifying ticket number when creating a ticket
---

## Requirements

### Phase 1: Custom Ticket IDs (Completed ✓)
- ✓ VS code create ticket form should include a field for specifying the ticket ID
    - ✓ VS code field should pre-populate with the next ticket number, but allow for editing to set a custom ID
- ✓ CLI tool should support specifying ticket number via `-n, --number` option
- ✓ Tests added for CLI

**Known Issue:** Currently only accepts numeric IDs (e.g. `12345`), fails on alphanumeric IDs like `JIRA-123` or `NTVARCH-23252`

### Phase 2: External Ticket System Integration (New Requirements)

#### Support Arbitrary String IDs
- Remove numeric-only validation from CLI and VS Code
- Accept any non-empty string as ticket ID (e.g. `NTVARCH-23252`, `JIRA-123`)
- File naming: Store external IDs as-is without prefix
  - External ID `NTVARCH-23252` → file: `NTVARCH-23252.md`
  - Auto-generated: `TICKET-0001.md` (or with custom prefix)

#### Project Prefix Configuration
- Create `.sabin/config.json` configuration file
- Support configurable project prefix (default: `TICKET`)
- Configuration structure:
  ```json
  {
    "projectPrefix": "OTEL",
    "ticketNumberPadding": 4
  }
  ```
- Update `sabin init` command to optionally set project prefix
- Example: `sabin init --prefix OTEL` creates config with `OTEL` prefix

#### Auto-increment Logic Updates
- Update `getNextTicketNumber()` in `@sabin/core/src/markdown.ts`:
  - Read prefix from config (default: `TICKET`)
  - Only auto-increment tickets matching `{prefix}-{number}` pattern
  - Ignore external IDs (e.g. `NTVARCH-23252`) when calculating next number
  - Search pattern: `/{configuredPrefix}-(\d+)\.md/`

#### VS Code Extension Updates
- Read config file on activation
- Use configured prefix when pre-populating ticket number field
- Display format: `{prefix}-{nextNumber}` (e.g. `OTEL-0001`)

#### CLI Updates
- Read config file when creating tickets
- Use configured prefix for auto-generated tickets
- Accept any string for `-n, --number` option (not just numeric)

## Implementation Plan

### Step 1: Configuration System
- [x] Create config type definition in `@sabin/core/src/types.ts`
- [x] Add config read/write utilities in `@sabin/core/src/config.ts`
- [x] Default config: `{ projectPrefix: "TICKET", ticketNumberPadding: 4 }`

### Step 2: Update Core Package
- [x] Modify `getNextTicketNumber()` to:
  - Accept config parameter
  - Use `config.projectPrefix` in regex pattern
  - Only count tickets matching `{prefix}-\d+` format
- [x] Update file naming logic to handle external IDs

### Step 3: Update CLI
- [x] Modify `init` command to support `--prefix` option
- [x] Update `create-ticket` command:
  - Remove numeric validation, accept any non-empty string
  - Read config to get prefix
  - Use prefix for auto-generated tickets only
- [x] Update tests for new validation logic

### Step 4: Update VS Code Extension
- [x] Read config on extension activation
- [x] Update `TicketService`:
  - Remove numeric validation
  - Use configured prefix for auto-generated tickets
  - Accept any string for custom ticket IDs
- [x] Update new ticket dialog to show configured prefix in placeholder

### Step 5: Documentation
- [x] Update README with configuration instructions
- [x] Add examples for JIRA integration workflow
- [x] Document migration path for existing projects

## Acceptance Criteria

- [x] Can create ticket with external ID: `sabin create-ticket -t "Fix bug" -n JIRA-12345`
- [x] Can configure project prefix: `sabin init --prefix OTEL`
- [x] Auto-increment respects configured prefix: `OTEL-0001`, `OTEL-0002`, etc.
- [x] Auto-increment ignores external IDs (only counts `{prefix}-\d+` tickets)
- [x] VS Code extension shows configured prefix in ticket number field
- [x] Validation accepts any non-empty string for ticket ID
- [x] Tests updated to cover:
  - Arbitrary string IDs
  - Custom prefix configuration
  - Auto-increment with mixed ticket types
- [x] Config file created by `init` command with default or specified prefix

## Example Workflows

### JIRA Integration
```bash
# Initialize with custom prefix
sabin init --prefix MYPROJECT

# Create internal tickets (auto-increment)
sabin create-ticket -t "Add feature"  # → MYPROJECT-0001.md

# Link external JIRA ticket
sabin create-ticket -t "Fix JIRA bug" -n JIRA-12345  # → JIRA-12345.md

# Next auto ticket continues sequence
sabin create-ticket -t "Another feature"  # → MYPROJECT-0002.md
```

### Multiple Ticket Systems
```bash
# Mix of internal and external tickets in same project
MYPROJECT-0001.md   # Internal
MYPROJECT-0002.md   # Internal
NTVARCH-23252.md    # External (Notion/JIRA)
JIRA-789.md         # External (JIRA)
MYPROJECT-0003.md   # Internal (continues from 0002)
```

