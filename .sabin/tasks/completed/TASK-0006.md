---
status: resolved
title: Webview 'New Ticket' button not appearing in VS Code extension sidebar
description: >-
  The webview with the create ticket button is not showing up in the Sabin
  sidebar, only the TreeView is visible
---

## Resolution

**Root Cause:** The webview HTML was referencing a non-existent `media/main.js` file, causing the webview to fail loading silently.

**Fix Applied:**
1. Removed unused `media/main.js` reference from webviewProvider.ts:229
2. Created symlink to development extension directory for proper dependency loading
3. Changed webview button handlers from `prompt()` to VS Code native commands

**Changes Made:**
- packages/vscode-extension/src/providers/webviewProvider.ts
  - Removed: `const scriptUri = webview.asWebviewUri(vscode.Uri.joinPath(this._extensionUri, 'media', 'main.js'));`
  - Modified button handlers to use message passing instead of prompt()

**Result:**
- ✅ Webview "Tickets Board" section now appears
- ✅ Ticket cards display correctly in kanban layout
- ✅ TreeView displays tickets simultaneously
- ⚠️ "New Ticket" button visible but not functional (new issue: TICKET-0008)

## Problem

When clicking the Sabin icon in the Activity Bar, only the **TreeView** ("Sabin Tickets" list) is visible. The **webview** with the "New Ticket" button and ticket board is not appearing.

**Expected Behavior:**
Two sections should appear in the Sabin sidebar:
1. **Tickets Board** (webview) - with "New Ticket" button and kanban-style board
2. **Sabin Tickets** (TreeView) - list of tickets grouped by status

**Actual Behavior:**
Only the TreeView is visible. No webview section appears.

## Investigation Findings

### Code Analysis

1. **Extension Registration (extension.ts:20-26)**
   ```typescript
   const provider = new SabinWebviewProvider(context.extensionUri);
   context.subscriptions.push(
     vscode.window.registerWebviewViewProvider(
       'sabin.ticketsView',  // ← View ID being registered
       provider
     )
   );
   ```
   ✅ Code correctly registers webview provider for `sabin.ticketsView`

2. **Package.json Configuration (FIXED)**
   - **Original issue**: Missing webview view declaration in `contributes.views.sabin`
   - **Fix applied**: Added webview view configuration:
   ```json
   {
     "type": "webview",
     "id": "sabin.ticketsView",
     "name": "Tickets Board"
   }
   ```
   - Updated package.json copied to `~/.vscode/extensions/sabin.sabin-vscode-0.1.0/`
   - ❌ **Still not working after reload**

3. **Webview Provider Implementation (webviewProvider.ts)**
   ```typescript
   public static readonly viewType = 'sabin.ticketsView';

   public resolveWebviewView(
     webviewView: vscode.WebviewView,
     context: vscode.WebviewViewResolveContext,
     _token: vscode.CancellationToken
   ) {
     this._view = webviewView;
     webviewView.webview.html = this.getHtmlForWebview(webviewView.webview);
     // ... message handlers
   }
   ```
   ✅ Implementation looks correct

### Current State

**Files Updated:**
- ✅ `packages/vscode-extension/package.json` - webview view added
- ✅ Copied to `~/.vscode/extensions/sabin.sabin-vscode-0.1.0/package.json`
- ✅ VS Code reloaded

**Extension Status:**
- ✅ Extension activates successfully (no gray-matter errors)
- ✅ TreeView displays correctly
- ❌ Webview not appearing

### Possible Root Causes

1. **VS Code caching issue**
   - VS Code may be caching the old extension manifest
   - Simple reload may not be enough
   - May need to uninstall/reinstall extension

2. **Webview view type syntax**
   - The `"type": "webview"` field may require different syntax
   - Or may not be needed at all (VS Code infers from registration)

3. **View visibility/when clause**
   - Webview may have implicit visibility conditions
   - May need explicit `"when"` clause or `"visibility"` property

4. **Media files missing**
   - Webview references `media/main.js` and `media/main.css`
   - These files may not exist or not be copied to installed extension
   - Check: `~/.vscode/extensions/sabin.sabin-vscode-0.1.0/media/`

5. **Console errors**
   - May be runtime errors preventing webview initialization
   - Need to check VS Code Developer Tools console

## Requirements

1. **Investigate media files**
   - Verify `media/main.js` and `media/main.css` exist in source
   - Verify they're copied to installed extension
   - Check if webview needs these files to render

2. **Check console for errors**
   - Open VS Code Developer Tools
   - Look for errors related to webview, sabin.ticketsView, or media files
   - Check if `resolveWebviewView()` is being called

3. **Try fresh installation**
   - Remove extension: `rm -rf ~/.vscode/extensions/sabin.sabin-vscode-0.1.0`
   - Reinstall: Copy dist/, package.json, node_modules, and media/
   - Test if webview appears

4. **Test package.json syntax variations**
   - Try removing `"type": "webview"` (may be inferred)
   - Try different view ordering
   - Reference other VS Code extensions with webviews

5. **Add debug logging**
   - Add console.log to `resolveWebviewView()` to confirm it's called
   - Log webview.html content to verify HTML generation

## Acceptance Criteria

- [ ] Webview "Tickets Board" section appears in Sabin sidebar
- [ ] "New Ticket" button visible in webview
- [ ] Clicking button opens input prompts for title/description
- [ ] Creating ticket via webview generates correct ticket number (e.g., TICKET-0007)
- [ ] Webview displays tickets in kanban board format
- [ ] Both webview and TreeView visible simultaneously

## Technical Notes

**Media Files Location:**
```
packages/vscode-extension/media/
  - main.js  (?)
  - main.css (?)
  - icon.svg
```

**Webview HTML (from webviewProvider.ts:225-367):**
- Uses inline JavaScript (in script tag with nonce)
- References external CSS: `media/main.css`
- May reference external JS: `media/main.js`
- CSP policy: `default-src 'none'; style-src ${webview.cspSource}; script-src 'nonce-${nonce}'`

**Similar Extensions to Reference:**
- Any extension with webview views in sidebar
- Example: GitLens, GitHub Pull Requests, etc.

